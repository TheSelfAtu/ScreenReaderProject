version: '2'
# service
services:
    # mysql
    mysql:
        image: mysql:5.7
        command: mysqld --character-set-server=utf8 --collation-server=utf8_unicode_ci
        ports:
            - "3306:3306"
        environment:
            MYSQL_DATABASE: db
            MYSQL_ROOT_USER: root
            MYSQL_ROOT_PASSWORD: root
        volumes:
            - $PWD/database:/var/lib/mysql


    # proxy
    proxy:
        image: jwilder/nginx-proxy:latest
        volumes:
            - /var/run/docker.sock:/tmp/docker.sock:ro
        ports:
            - "80:80"
    # www
    www:
        image: atsu666/ioncube:7.3 # phpのバージョンにあったものを指定
        privileged: true
        volumes:
            - $PWD:/var/www/html
        links:
            - mysql:mysql
        environment:
            - VIRTUAL_HOST=acms.com,www.acms.com # host名を指定
            - APACHE_DOCUMENT_ROOT=/var/www/html # ドキュメントルートを指定
